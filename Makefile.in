# $Id: Makefile.in,v 1.10 2000/08/14 01:25:03 leonard Exp $

PYTHON=		@PYTHON@
LIBDEST=	@LIBDEST@
INSTALL=	$(LIBDEST)/config/install-sh
INSTALL_DATA=	$(INSTALL) -m 644
INSTALL_DIR=	mkdir -p
srcdir=		@srcdir@

MAKEVARS=	srcdir=$(srcdir)/Modules VPATH=$(srcdir)/Modules

build:   _ldapmodule-build 
install: _ldapmodule-install 

_ldapmodule-build:
	cd Modules && $(MAKE) $(MAKEVARS)

_ldapmodule-install:
	$(INSTALL_DIR) $(DESTDIR)$(LIBDEST)/site-packages/python-ldap
	cd Modules && $(MAKE) $(MAKEVARS) install \
				prefix='${DESTDIR}$${installdir}'
	$(INSTALL_DIR) $(DESTDIR)$(LIBDEST)/site-packages/python-ldap
	$(INSTALL_DATA) $(srcdir)/Misc/ldap.pth \
		$(DESTDIR)$(LIBDEST)/site-packages/ldap.pth
	for f in $(srcdir)/Lib/*.py; do \
	   $(INSTALL_DATA) $$f $(DESTDIR)$(LIBDEST)/site-packages/python-ldap/;\
        done
	#-- XXX need to copy contents of $(srcdir)/Lib/* to the new directory
	$(PYTHON) $(LIBDEST)/compileall.py \
		$(DESTDIR)$(LIBDEST)/site-packages/python-ldap
	$(PYTHON) -O $(LIBDEST)/compileall.py \
		$(DESTDIR)$(LIBDEST)/site-packages/python-ldap

